<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vancouver Sun - Home</title>

    <meta name="chat-context-publication" content="Vancouver Sun">
    <meta name="chat-context-page" content="Home">

    <style>
        /* --- GLOBAL STYLES (Newspaper Look) --- */
        body {
            margin: 0;
            font-family: 'Times New Roman', serif;
            background-color: #e8e8e8;
            color: #1a1a1a;
        }

        /* HEADER */
        header {
            background: linear-gradient(to bottom, #003d7a, #0052a3);
            color: #fff;
            padding: 20px 0;
            border-bottom: 5px solid #ffa500;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 25px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            font-size: 36px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .tagline {
            font-size: 11px;
            font-style: italic;
            color: #ffa500;
            margin-top: 5px;
        }

        /* NAVIGATION */
        nav {
            padding-top: 12px;
        }

        nav a {
            color: #fff;
            text-decoration: none;
            margin-right: 30px;
            font-family: 'Arial', sans-serif;
            font-size: 15px;
            font-weight: 600;
            text-transform: uppercase;
            transition: color 0.3s ease;
        }

        nav a:hover {
            color: #ffa500;
        }

        /* CONTENT LAYOUT */
        .main-content {
            background: #fff;
            margin-top: 25px;
            padding: 50px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
            min-height: 500px;
            border-left: 3px solid #0052a3;
        }

        h1 {
            font-size: 38px;
            margin-bottom: 12px;
            color: #003d7a;
            font-weight: bold;
            line-height: 1.2;
        }

        .article-meta {
            color: #666;
            font-size: 13px;
            font-family: 'Arial', sans-serif;
            margin-bottom: 25px;
            border-bottom: 2px solid #ffa500;
            padding-bottom: 12px;
        }

        p {
            line-height: 1.8;
            font-size: 17px;
            margin-bottom: 22px;
            color: #2a2a2a;
        }

        /* STORY LIST */
        .more-stories {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 3px solid #0052a3;
        }

        .more-stories h3 {
            color: #003d7a;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .more-stories ul {
            list-style: none;
            padding: 0;
        }

        .more-stories li {
            padding: 12px 0;
            border-bottom: 1px solid #ddd;
            font-size: 16px;
        }

        .more-stories li:before {
            content: "▸ ";
            color: #ffa500;
            font-weight: bold;
            margin-right: 8px;
        }

        /* FOOTER */
        footer {
            background: linear-gradient(to top, #001f3f, #003d7a);
            color: #aaa;
            padding: 45px 0;
            margin-top: 50px;
            text-align: center;
            font-family: 'Arial', sans-serif;
            font-size: 13px;
        }

        /* --- CHAT BUTTON STYLES --- */
        #endChatButton {
            display: none;
            position: fixed;
            bottom: 588px;
            right: 55px;
            /* Position in the blue header area */
            z-index: 2147483647;
            padding: 4px 12px;
            background-color: #607d8b;
            /* Slate blue to match widget header */
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Arial', sans-serif;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }

        #endChatButton:hover {
            background-color: #455a64;
            transform: translateY(-1px);
        }

        #endChatButton:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* --- RESPONSIVE DESIGN --- */
        @supports (-webkit-touch-callout: none) {

            input,
            textarea {
                font-size: 16px !important;
            }
        }

        @media screen and (max-width: 768px) {

            /* Header adjustments */
            .logo {
                font-size: 24px;
                letter-spacing: 1px;
            }

            .tagline {
                font-size: 9px;
            }

            /* Navigation - stack vertically */
            nav {
                padding-top: 10px;
            }

            nav a {
                display: inline-block;
                margin-right: 15px;
                margin-bottom: 8px;
                font-size: 13px;
            }

            /* Content adjustments */
            .main-content {
                padding: 25px 20px;
                margin-top: 15px;
                border-left: 2px solid #0052a3;
            }

            h1 {
                font-size: 28px;
            }

            p {
                font-size: 16px;
            }

            .article-meta {
                font-size: 12px;
            }

            .more-stories h3 {
                font-size: 20px;
            }

            .more-stories li {
                font-size: 15px;
            }
        }

        @media screen and (max-width: 480px) {
            .logo {
                font-size: 20px;
            }

            .tagline {
                font-size: 8px;
            }

            nav a {
                margin-right: 10px;
                font-size: 12px;
            }

            .main-content {
                padding: 20px 15px;
            }

            h1 {
                font-size: 24px;
            }

            h2 {
                font-size: 22px;
            }

            h3 {
                font-size: 18px;
            }

            p {
                font-size: 15px;
            }

            #endChatButton {
                bottom: 20px;
                right: 15px;
                padding: 8px 15px;
                font-size: 14px;
            }
        }
    </style>

    <script>
        !function (o, i, s, c) { var a, p, h, u = [], l = []; function e() { var t = "You must provide a supported major version."; try { if (!c) throw new Error(t); var e, n = "https://sdk.cxengage.net/webchat/2.6.11/", r = "serenovawebchat"; if ((e = "string" == typeof this.response ? JSON.parse(this.response) : this.response).url) { var o = i.getElementsByTagName("script")[0], s = i.createElement("script"); s.async = !0; var a = c.match(/([0-9]+)\.?([0-9]+)?\.?([0-9]+)?/), p = a && a[1]; if (a && a[3]) s.src = n + r + "." + c + ".min.js"; else { if (!(1 <= p && e["v" + p])) throw new Error(t); s.src = e["v" + p] } o.parentNode.insertBefore(s, o) } } catch (e) { e.message === t && console.error(e) } } o[s] = { init: function () { a = arguments; var t = { then: function (e) { return l.push({ type: "t", next: e }), t }, catch: function (e) { return l.push({ type: "c", next: e }), t } }; return t }, on: function () { u.push(arguments) }, render: function () { p = arguments }, destroy: function () { h = arguments } }, o.__onWebMessengerHostReady__ = function (e) { if (delete o.__onWebMessengerHostReady__, o[s] = e, a) for (var t = e.init.apply(e, a), n = 0; n < l.length; n++) { var r = l[n]; t = "t" === r.type ? t.then(r.next) : t.catch(r.next) } p && e.render.apply(e, p), h && e.destroy.apply(e, h); for (n = 0; n < u.length; n++)e.on.apply(e, u[n]) }; var t = new XMLHttpRequest; t.addEventListener("load", e), t.open("GET", "https://sdk.cxengage.net/webchat/2.6.11/loader.json", !0), t.responseType = "json", t.send() }(window, document, "SerenovaWebChat", "2");
    </script>
</head>

<body>

    <header>
        <div class="container">
            <div class="header-top">
                <div>
                    <div class="logo">Vancouver Sun</div>
                    <div class="tagline">The Voice of British Columbia Since 1912</div>
                </div>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="faqs.html">FAQs</a>
                <a href="subscription.html">Subscription</a>
            </nav>
        </div>
    </header>

    <div class="container main-content">
        <h1>Metro Vancouver Transit Expansion Gets Provincial Funding</h1>
        <div class="article-meta">By <strong>Sarah Chen</strong> | Published Feb 05, 2026 | Metro News</div>

        <p>VANCOUVER, BC — The provincial government announced today a major funding commitment for the expansion of
            Metro Vancouver's rapid transit network. The $2.3 billion investment will accelerate the development of new
            SkyTrain lines connecting Surrey and Langley.</p>

        <p>"This is a transformative moment for public transportation in our region," said Transportation Minister David
            Williams. "These new lines will reduce congestion, lower emissions, and connect communities across the Lower
            Mainland."</p>

        <p>Construction is expected to begin in early 2027, with the first phase scheduled for completion by 2031. The
            expansion is projected to serve an additional 100,000 daily commuters once fully operational.</p>

        <div class="more-stories">
            <h3>More Top Stories</h3>
            <ul>
                <li>Vancouver Canucks extend winning streak to seven games</li>
                <li>Heavy snowfall warning issued for North Shore mountains</li>
                <li>Tech sector hiring boom continues in downtown Vancouver</li>
                <li>BC housing market shows signs of stabilization</li>
            </ul>
        </div>
    </div>

    <footer>
        <div class="container">
            &copy; 2026 Postmedia Network Inc. All rights reserved.<br>
            Unauthorized distribution, transmission or republication strictly prohibited.
        </div>
    </footer>

    <button id="endChatButton">End Chat</button>

    <script>
        // Global Configuration
        const CHAT_CONFIG = {
            integrationId: '6966665f56c845c31a432939',
            storageType: 'sessionStorage'
        };

        let activeConversationId = null;
        const endChatBtn = document.getElementById('endChatButton');

        /**
         * 1. GET CONTEXT
         * Reads the <meta> tags from the <head> of the current HTML file.
         */
        function getPageContext() {
            const pubMeta = document.querySelector('meta[name="chat-context-publication"]');
            const pageMeta = document.querySelector('meta[name="chat-context-page"]');

            return {
                publication: pubMeta ? pubMeta.content : 'Unknown Publication',
                pageSource: pageMeta ? pageMeta.content : 'Unknown Page',
                url: window.location.href
            };
        }

        /**
         * 2. INIT CHAT
         * Initializes the SDK and sends the specific page data.
         */
        function initChatWidget() {
            if (typeof SerenovaWebChat === 'undefined') {
                setTimeout(initChatWidget, 100);
                return;
            }

            const options = {
                integrationId: CHAT_CONFIG.integrationId,
                canUserSeeConversationList: true,
                browserStorage: CHAT_CONFIG.storageType,
                customText: {
                    headerText: "How can I help?",
                    prechatCaptureGreetingText: `Hi! I'm Postmedia's virtual assistant.`,
                    prechatCaptureConfirmationText: `Thank you. How can I help you today?`,
                    notificationSettingsConnected: "",
                },

                prechatCapture: {
                    fields: [
                        {
                            type: 'text',
                            name: 'email',
                            label: 'To get started, please provide your email address:',
                            placeholder: 'your email',
                        },
                    ],
                },
                delegate: {
                    beforeDisplay: (message) => {
                        if (message?.metadata?.conversationId) {
                            activeConversationId = message.metadata.conversationId;
                        }
                        return message;
                    }
                }
            };

            SerenovaWebChat.init(options).then(() => {
                console.log("SDK Initialized successfully.");

                const context = getPageContext();
                console.log(`[Chat Context] Sending: ${context.pageSource} (${context.publication})`);

                SerenovaWebChat.updateUser({
                    properties: {
                        publication: context.publication,
                        pageSource: context.pageSource,
                        sourceUrl: context.url
                    }
                }).catch(err => console.error("Failed to update user properties:", err));

                // Inject CSS into the chat widget iframe to prevent iOS zoom on input focus
                const injectIframeStyles = () => {
                    const messengerIframe = document.getElementById('web-messenger-container');
                    if (messengerIframe) {
                        const iframeDoc = messengerIframe.contentDocument || messengerIframe.contentWindow.document;
                        if (iframeDoc && !iframeDoc.getElementById('ios-zoom-fix')) {
                            let zoomFix = iframeDoc.createElement('style');
                            zoomFix.id = 'ios-zoom-fix';
                            zoomFix.innerHTML = `@supports (-webkit-touch-callout: none) { input, textarea { font-size: 16px !important; } }`;
                            iframeDoc.head.appendChild(zoomFix);
                            console.log("[Chat Fix] iOS zoom fix injected into iframe.");
                        }
                    }
                };

                // Apply fix when widget is opened or loaded
                SerenovaWebChat.on('widget:opened', injectIframeStyles);
                injectIframeStyles(); // Try immediately as well

                // Show the "End Chat" button when the widget is open and hide it when closed
                SerenovaWebChat.on('widget:opened', () => endChatBtn.style.display = 'block');
                SerenovaWebChat.on('widget:closed', () => endChatBtn.style.display = 'none');
            });
        }

        /**
         * 3. END CHAT FUNCTIONALITY
         * Gracefully disconnects and resets the session.
         */
        function handleEndChat() {
            endChatBtn.innerText = "Ending...";
            endChatBtn.disabled = true;

            const performReset = () => {
                SerenovaWebChat.destroy();
                sessionStorage.clear();
                activeConversationId = null;
                endChatBtn.style.display = 'none';
                endChatBtn.innerText = "End Chat";
                endChatBtn.disabled = false;

                setTimeout(initChatWidget, 1000);
            };

            if (activeConversationId) {
                SerenovaWebChat.sendMessage({
                    type: 'text',
                    text: 'disconnect-conversation',
                    metadata: { type: 'disconnect-conversation' }
                }, activeConversationId)
                    .then(() => setTimeout(performReset, 500))
                    .catch(() => performReset());
            } else {
                performReset();
            }
        }

        document.addEventListener('DOMContentLoaded', initChatWidget);
        endChatBtn.addEventListener('click', handleEndChat);

    </script>
</body>

</html>